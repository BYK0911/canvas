{"version":3,"sources":["webpack:///./src/views/template/components/tools/pen/index.vue","webpack:///./src/views/template/components/tools/pen/index.vue?0727","webpack:///./src/views/template/components/tools/size/drawer/index.vue","webpack:///./src/views/template/components/tools/size/drawer/index.vue?40d7","webpack:///./src/views/template/components/tools/size/index.vue","webpack:///./src/views/template/components/tools/size/index.vue?9387","webpack:///./src/views/template/components/tools/color/index.vue","webpack:///./src/views/template/components/tools/color/index.vue?d840","webpack:///./src/views/template/components/tools/undo/index.vue","webpack:///./src/views/template/components/tools/undo/index.vue?d458","webpack:///./src/views/template/components/tools/redo/index.vue","webpack:///./src/views/template/components/tools/redo/index.vue?167c","webpack:///./src/views/template/components/tools/clear/index.vue","webpack:///./src/views/template/components/tools/clear/index.vue?881f","webpack:///./src/views/template/components/tools/export/drawer/index.vue","webpack:///./src/views/template/components/tools/export/drawer/index.vue?ebb2","webpack:///./src/views/template/components/tools/export/index.vue","webpack:///./src/views/template/components/tools/export/index.vue?d44c","webpack:///./src/views/template/components/tools/resetViewport/index.vue","webpack:///./src/views/template/components/tools/resetViewport/index.vue?f219","webpack:///./src/views/template/components/tools/more/index.vue","webpack:///./src/views/template/components/tools/more/index.vue?b903","webpack:///./src/views/template/components/tools/index.vue","webpack:///./src/views/template/components/tools/index.vue?26ac","webpack:///./src/views/template/event/panzoom.ts","webpack:///./src/views/template/event/draw.ts","webpack:///./src/modules/canvas/utils/magicWand.ts","webpack:///./src/modules/canvas/layer/Rasterized.ts","webpack:///./src/views/template/event/buket.ts","webpack:///./src/views/template/event/index.ts","webpack:///./src/views/template/canvas.vue","webpack:///./src/views/template/canvas.vue?2e36","webpack:///./src/modules/coord/index.ts","webpack:///./src/views/template/components/tools/size/index.vue?87c2","webpack:///./src/views/template/components/tools/more/index.vue?380d","webpack:///./src/views/template/components/tools/size/drawer/index.vue?0743","webpack:///./src/views/template/components/tools/index.vue?91de","webpack:///./src/modules/canvas/painter/pen.ts","webpack:///./src/modules/canvas/painter/eraser.ts","webpack:///./src/modules/canvas/layer/path.ts","webpack:///./src/modules/canvas/utils/memo.ts","webpack:///./src/modules/canvas/event/index.ts","webpack:///./src/modules/canvas/canvas.ts","webpack:///./src/views/template/canvas.vue?c349","webpack:///./src/modules/canvas/layer/index.ts","webpack:///./src/views/template/index.ts","webpack:///./src/views/template/canvas.vue?f78c","webpack:///./src/views/template/components/tools/export/drawer/index.vue?6ce6","webpack:///./src/views/template/components/tools/index.vue?d5b5"],"names":["_hoisted_1","_defineComponent","__name","setup","__props","pens","name","icon","setPainter","painter","setting","mode","_ctx","_cache","_openBlock","_createElementBlock","_Fragment","_renderList","p","i","_createElementVNode","key","class","_normalizeClass","_unref","onClick","$event","__exports__","_withScopeId","n","_pushScopeId","_popScopeId","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","sizes","size","ref","pen","eraser","setSize","v","value","_component_el_slider","_resolveComponent","s","style","_normalizeStyle","width","height","_createVNode","modelValue","onChange","min","max","openDrawer","inject","Drawer","predefined","setPredefined","c","color","includes","unshift","drag","e","touches","length","x","pageX","y","pageY","dragend","window","removeEventListener","document","elementFromPoint","cvs","dom","emit","addEventListener","_component_el_color_picker","onTouchstart","predefine","undo","memo","redo","_createTextVNode","clear","layers","reset","refreshImage","src","toDataURL","resetViewport","scale","rotation","backgroundColor","background","showBg","setTimeout","show","_component_el_dropdown_item","_component_el_dropdown_menu","_component_el_dropdown","placement","dropdown","_withCtx","default","_","ResetViewport","Export","divided","Clear","ref_key","props","cmpts","Pen","Size","Color","Undo","Redo","MoreOptions","tools","_createBlock","_resolveDynamicComponent","x0","x1","y0","y1","on","ev","_x0","_y0","_x1","_y1","Coord","_v","ang","angle","cross","k","norm","c0","getRelativeCoord","rotate","c1","move","path","moved","offsetY","type","Path","data","push","activePath","add","magicWand","imageData","px","py","threshold","distance","p1","p2","sum","Math","abs","d","w","h","checked","Set","res","p0","check","has","index","Layer","constructor","img","super","this","ps","forEach","_x","_y","draw","ctx","translate","drawImage","floor","getImageData","undefined","_cvs","createElement","getContext","fillStyle","fillRect","round","layer","Rasterized","panzoom","buket","cvsWrap","closeDrawer","animateId","render","drawFrame","requestAnimationFrame","provide","drawer","markRaw","onMounted","mount","initEvent","onBeforeMount","cancelAnimationFrame","Tools","_Transition","_createCommentVNode","matrix","a","b","f","dx","dy","cos","sin","kx","ky","skewX","PI","tan","skewY","sqrt","normalVector","unit","n2","dot","acos","flip","m","q","opt","beginPath","arc","closePath","fill","moveTo","lineTo","strokeStyle","lineWidth","lineCap","lineJoin","stroke","force","globalCompositeOperation","_boundingBox","drawPen","drawEraser","slice","head","splice","touchstart","preventDefault","touchmove","touchend","Canvas","handlers","initDom","willReadFrequently","activeCanvas","activeCtx","Object","assign","verticalAlign","appendChild","offsetWidth","offsetHeight","resize","getBoundingBox","save","restore","rs","map","l","_s","boundingBox","_w","_h","clearRect","eventType","eventHandler","off","indexOf","args","cb","Memo","reactive"],"mappings":"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","file":"js/chunk-2b187420.403a3587.js","sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, unref as _unref, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode } from \"vue\"\n\nconst _hoisted_1 = [\"onClick\"]\n\nimport { setting } from '../../../index'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst pens = [\n  { name: 'pen', icon: 'icon-pen1' },\n  { name: 'eraser', icon: 'icon-eraser' },\n]\nconst setPainter = (painter: string) => {\n  setting.mode = painter\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(_Fragment, null, _renderList(pens, (p, i) => {\n    return _createElementVNode(\"span\", {\n      key: i,\n      class: _normalizeClass([\"iconfont\", p.name === _unref(setting).mode ? \"is-active \" + p.icon : p.icon]),\n      onClick: ($event: any) => (setPainter(p.name))\n    }, null, 10, _hoisted_1)\n  }), 64))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle, resolveComponent as _resolveComponent, createVNode as _createVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-3d8d9118\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"panel\" }\nconst _hoisted_2 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"panel-header\" }, \" 粗细 \", -1))\nconst _hoisted_3 = { class: \"panel-body\" }\nconst _hoisted_4 = { class: \"size-wrap flex\" }\nconst _hoisted_5 = [\"onClick\"]\nconst _hoisted_6 = { class: \"panel-body\" }\n\nimport { ref } from 'vue'\nimport { setting } from '../../../..'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst sizes = [1, 5, 10, 15, 20, 25]\nconst size = ref(setting.mode === 'pen' ? setting.pen.size : setting.eraser.size)\nconst setSize = (v: number) => {\n  size.value = v\n  if (setting.mode === 'pen') {\n    setting.pen.size = v\n  } else {\n    setting.eraser.size = v\n  }\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_slider = _resolveComponent(\"el-slider\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _hoisted_2,\n    _createElementVNode(\"div\", _hoisted_3, [\n      _createElementVNode(\"div\", _hoisted_4, [\n        (_openBlock(), _createElementBlock(_Fragment, null, _renderList(sizes, (s) => {\n          return _createElementVNode(\"span\", {\n            class: \"size\",\n            key: s,\n            onClick: ($event: any) => (setSize(s))\n          }, [\n            _createElementVNode(\"span\", {\n              class: \"size-inner\",\n              style: _normalizeStyle({\n              width: s + 'px',\n              height: s + 'px',\n            })\n            }, null, 4)\n          ], 8, _hoisted_5)\n        }), 64))\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_6, [\n      _createVNode(_component_el_slider, {\n        modelValue: size.value,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((size).value = $event)),\n        onChange: setSize,\n        min: 1,\n        max: 50\n      }, null, 8, [\"modelValue\"])\n    ])\n  ]))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=3d8d9118&scoped=true&lang=scss\"\n\nimport exportComponent from \"/Users/baoyukun/Workspace/canvas/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3d8d9118\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-201e08b8\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", { class: \"sizeicon\" }, null, -1))\nconst _hoisted_2 = [\n  _hoisted_1\n]\n\nimport { inject } from 'vue'\nimport Drawer from './drawer/index.vue'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst openDrawer = inject('openDrawer')\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"span\", {\n    class: \"iconfont\",\n    onClick: _cache[0] || (_cache[0] = ($event: any) => (_unref(openDrawer)(Drawer)))\n  }, _hoisted_2))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=201e08b8&scoped=true&lang=scss\"\n\nimport exportComponent from \"/Users/baoyukun/Workspace/canvas/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-201e08b8\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport { ref } from 'vue';\nimport { cvs, setting } from '../../../index'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst predefined = ref<string[]>([])\nconst setPredefined = (c: string) => {\n  if (c === null) {\n    c = setting.pen.color = 'rgba(0, 0, 0, 1)'\n  }\n\n  if (predefined.value.includes(c)) return\n\n  predefined.value.unshift(c)\n}\n\nconst drag = (e: TouchEvent) => {\n  if (e.touches.length > 1) return\n  let x = e.touches[0].pageX\n  let y = e.touches[0].pageY\n\n  const drag = (e: TouchEvent) => {\n    x = e.touches[0].pageX\n    y = e.touches[0].pageY\n  }\n\n  const dragend = (): void => {\n    window.removeEventListener('touchend', dragend)\n    window.removeEventListener('touchmove', drag)\n\n    if (document.elementFromPoint(x, y) === cvs.dom) {\n      cvs.emit('drop', { x, y })\n    }\n  }\n\n  window.addEventListener('touchmove', drag)\n  window.addEventListener('touchend', dragend)\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_color_picker = _resolveComponent(\"el-color-picker\")!\n\n  return (_openBlock(), _createElementBlock(\"span\", { onTouchstart: drag }, [\n    _createVNode(_component_el_color_picker, {\n      class: \"color-picker\",\n      modelValue: _unref(setting).pen.color,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_unref(setting).pen.color) = $event)),\n      onChange: setPredefined,\n      \"show-alpha\": \"\",\n      predefine: predefined.value\n    }, null, 8, [\"modelValue\", \"predefine\"])\n  ], 32))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport { memo } from '../../..'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst undo = () => memo.undo()\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"span\", {\n    class: \"iconfont icon-Undo\",\n    onClick: undo\n  }))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport { memo } from '../../..'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst redo = () => memo.redo()\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"span\", {\n    class: \"iconfont icon-Redo\",\n    onClick: redo\n  }))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"span\", { class: \"iconfont icon-delete\" }, null, -1)\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\" 清除屏幕 \")\nconst _hoisted_3 = [\n  _hoisted_1,\n  _hoisted_2\n]\n\nimport { memo, cvs } from '../../../index'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst clear = () => {\n  cvs.layers = []\n  memo.reset()\n  cvs.refreshImage()\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"span\", {\n    style: {\"color\":\"red\"},\n    onClick: clear\n  }, _hoisted_3))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-7f8b0450\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, \"长按保存图片\", -1))\nconst _hoisted_2 = { class: \"img-wrap\" }\nconst _hoisted_3 = [\"src\"]\n\nimport { inject } from 'vue'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst cvs = inject('cvs')\nconst src = cvs.dom.toDataURL()\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _hoisted_1,\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"img\", { src: _unref(src) }, null, 8, _hoisted_3)\n    ])\n  ], 64))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=7f8b0450&scoped=true&lang=scss\"\n\nimport exportComponent from \"/Users/baoyukun/Workspace/canvas/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7f8b0450\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, unref as _unref, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"span\", { class: \"iconfont icon-download\" }, null, -1)\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\"导出图片 \")\nconst _hoisted_3 = [\n  _hoisted_1,\n  _hoisted_2\n]\n\nimport { inject } from 'vue'\nimport Drawer from './drawer/index.vue'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst openDrawer = inject('openDrawer')\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"span\", {\n    onClick: _cache[0] || (_cache[0] = ($event: any) => (_unref(openDrawer)(Drawer)))\n  }, _hoisted_3))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"span\", { class: \"iconfont icon-marquee\" }, null, -1)\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\"重置视口 \")\nconst _hoisted_3 = [\n  _hoisted_1,\n  _hoisted_2\n]\n\nimport { cvs } from '../../../index'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst resetViewport = (): void => {\n  cvs.x = 0\n  cvs.y = 0\n  cvs.scale = 1\n  cvs.rotation = 0\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"span\", { onClick: resetViewport }, _hoisted_3))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, unref as _unref, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-2d6942a2\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", { class: \"iconfont icon-menu\" }, null, -1))\nconst _hoisted_2 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", { class: \"iconfont icon-background-f\" }, null, -1))\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\" 背景颜色 \")\nconst _hoisted_4 = { class: \"picker\" }\n\nimport { ref } from 'vue';\nimport Clear from '../clear/index.vue'\nimport Export from '../export/index.vue'\nimport ResetViewport from '../resetViewport/index.vue';\nimport { cvs } from '../../..'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst predefine = ref<string[]>([])\nconst setPredefined = (c: string) => {\n  if (c === null) {\n    c = cvs.backgroundColor = 'rgba(255,255,255, 1)'\n  }\n\n  if (predefine.value.includes(c)) return\n\n  predefine.value.unshift(c)\n}\n\nconst background = ref()\nconst showBg = () => {\n  setTimeout(() => {\n    background.value.show()\n  }, 200)\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_dropdown_item = _resolveComponent(\"el-dropdown-item\")!\n  const _component_el_dropdown_menu = _resolveComponent(\"el-dropdown-menu\")!\n  const _component_el_dropdown = _resolveComponent(\"el-dropdown\")!\n  const _component_el_color_picker = _resolveComponent(\"el-color-picker\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createVNode(_component_el_dropdown, { placement: \"top\" }, {\n      dropdown: _withCtx(() => [\n        _createVNode(_component_el_dropdown_menu, null, {\n          default: _withCtx(() => [\n            _createVNode(_component_el_dropdown_item, { onClick: showBg }, {\n              default: _withCtx(() => [\n                _hoisted_2,\n                _hoisted_3\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_el_dropdown_item, null, {\n              default: _withCtx(() => [\n                _createVNode(ResetViewport)\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_el_dropdown_item, null, {\n              default: _withCtx(() => [\n                _createVNode(Export)\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_el_dropdown_item, { divided: \"\" }, {\n              default: _withCtx(() => [\n                _createVNode(Clear)\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        })\n      ]),\n      default: _withCtx(() => [\n        _hoisted_1\n      ]),\n      _: 1\n    }),\n    _createElementVNode(\"span\", _hoisted_4, [\n      _createVNode(_component_el_color_picker, {\n        class: \"color-picker\",\n        ref_key: \"background\",\n        ref: background,\n        onChange: setPredefined,\n        modelValue: _unref(cvs).backgroundColor,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_unref(cvs).backgroundColor) = $event)),\n        predefine: predefine.value,\n        \"show-alpha\": \"\"\n      }, null, 8, [\"modelValue\", \"predefine\"])\n    ])\n  ], 64))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=2d6942a2&scoped=true&lang=scss\"\n\nimport exportComponent from \"/Users/baoyukun/Workspace/canvas/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2d6942a2\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveDynamicComponent as _resolveDynamicComponent, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-5b95560c\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"menu\" }\n\nimport Pen from './pen/index.vue'\nimport Size from './size/index.vue'\nimport Color from './color/index.vue'\nimport Undo from './undo/index.vue'\nimport Redo from './redo/index.vue'\nimport MoreOptions from './more/index.vue'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  props: ['tools'],\n  setup(__props) {\n\nconst cmpts: Record<string, unknown> = {\n  Pen,\n  Size,\n  Color,\n  Undo,\n  Redo,\n  MoreOptions\n}\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.tools, (c, i) => {\n      return (_openBlock(), _createBlock(_resolveDynamicComponent(cmpts[c as string]), { key: i }))\n    }), 128))\n  ]))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=5b95560c&scoped=true&lang=scss\"\nimport \"./index.vue?vue&type=style&index=1&id=5b95560c&lang=css\"\n\nimport exportComponent from \"/Users/baoyukun/Workspace/canvas/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5b95560c\"]])\n\nexport default __exports__","import { Canvas } from \"@/modules/canvas\"\nimport Coord from '@/modules/coord'\n\nlet x0: number, x1: number, y0: number, y1: number;\n\nexport default function (cvs: Canvas): void {\n  cvs.on('touchstart', e => {\n    const ev = e as TouchEvent\n    if (ev.touches.length === 2) {\n      x0 = ev.touches[0].pageX\n      y0 = ev.touches[0].pageY\n      x1 = ev.touches[1].pageX\n      y1 = ev.touches[1].pageY\n    }\n  })\n\n  cvs.on('touchmove', e => {\n    const ev = e as TouchEvent\n    if (ev.touches.length === 2) {\n      const _x0 = ev.touches[0].pageX\n      const _y0 = ev.touches[0].pageY\n      const _x1 = ev.touches[1].pageX\n      const _y1 = ev.touches[1].pageY\n      const v = new Coord(x1 - x0, y1 - y0)\n      const _v = new Coord(_x1 - _x0, _y1 - _y0)\n      const ang = v.angle(_v.x, _v.y)\n      const angle = v.cross(_v.x, _v.y) > 0 ? ang : -ang\n      const k = _v.norm() / v.norm()\n      const c0 = cvs.getRelativeCoord((x0 + x1) / 2, (y0 + y1) / 2)\n      \n      cvs.rotation += angle\n      cvs.scale *= k\n      // cvs.scale = Math.min(5, Math.max(0.1, cvs.scale * k))\n      c0.rotate(cvs.rotation)\n        .scale(cvs.scale, cvs.scale)\n      const c1 = new Coord((_x0 + _x1) / 2, (_y0 + _y1) / 2).move(-c0.x, -c0.y)\n      cvs.x = c1.x\n      cvs.y = c1.y\n\n      x0 = _x0\n      x1 = _x1\n      y0 = _y0\n      y1 = _y1\n    }\n  })\n}","import { Canvas, Path } from \"@/modules/canvas\"\nimport { memo, setting } from \"../../template\"\n\nlet path: Path | null = null;\nlet moved = false;\nconst offsetY = 45;\n\nexport default function (cvs: Canvas): void {\n  cvs.on('touchstart', e => {\n    const ev = e as TouchEvent\n    if (ev.touches.length === 1) {\n      const painter: {\n        type: 'pen' | 'eraser',\n        size: number,\n        force?: number,\n        color?: string\n      } = setting.mode === 'pen' ? { type: 'pen', ...setting.pen } : { type: 'eraser', ...setting.eraser }\n      const c = cvs.getRelativeCoord(ev.touches[0].pageX, ev.touches[0].pageY - offsetY)\n      path = new Path(painter)\n      path.data.push(c.x, c.y)\n    }\n  })\n\n  cvs.on('touchmove', e => {\n    const ev = e as TouchEvent\n    if (ev.touches.length === 1) {\n      if (path) {\n        const c = cvs.getRelativeCoord(ev.touches[0].pageX, ev.touches[0].pageY - offsetY)\n        path.data.push(c.x, c.y)\n        if (!moved) {\n          cvs.activePath = path\n          moved = true\n        }\n      }\n    }\n  })\n\n  cvs.on('touchend', () => {\n    if (moved) memo.add(path as Path)\n    moved = false;\n    cvs.activePath = null\n    path = null\n  })\n}","export default function magicWand (imageData: ImageData, px: number, py: number, threshold = 80): number[][] {\n  const distance = (p1: number[], p2: number[], threshold: number): boolean => {\n    let sum = 0;\n    for (let i = 0; i < 4; i++) {\n      sum += Math.abs(p1[i] - p2[i])\n      if (sum > threshold) return false;\n    }\n    return true;\n  }\n\n  const d = imageData.data;\n  const w = imageData.width;\n  const h = imageData.height;\n  const checked = new Set();\n  const res = [[px, py]];\n  const i = (py * w + px) * 4;\n  const p0 = [d[i], d[i + 1], d[i + 2], d[i + 3]];\n\n  const check = (x: number, y: number) => {\n    if (checked.has(`${x},${y}`)) return\n    checked.add(`${x},${y}`);\n\n    const i = (y * w + x) * 4;\n    if (distance(p0, [d[i], d[i + 1], d[i + 2], d[i + 3]], threshold)) {\n      res.push([x, y])\n    }\n  }\n\n  let index = 0\n  while (index < res.length) {\n    const [x, y] = res[index];\n    \n    if (y > 0) check(x, y - 1)\n    if (x > 0) check(x - 1, y)\n    if (x < w - 1) check(x + 1, y)\n    if (y < h - 1) check(x, y + 1)\n    index++;\n  }\n\n  return res;\n}","import { Layer, BoundingBox } from \".\"\nimport Coord from \"@/modules/coord\"\nexport default class Path extends Layer {\n  type = 'Rasterized'\n  x = 0\n  y = 0\n  width = 100\n  height = 100\n  rotation = 0\n  img: HTMLCanvasElement\n  _boundingBox?: BoundingBox;\n\n  get boundingBox () {\n    const { x, y, width: w, height: h, rotation } = this\n    const ps = [[w, 0], [w, h], [0, h]]\n    let x0 = 0\n    let y0 = 0\n    let x1 = 0\n    let y1 = 0\n    ps.forEach(p => {\n      const { x: _x, y: _y } = new Coord(p[0], p[1]).rotate(rotation)\n      if (_x < x0) x0 = _x\n      if (_x > x1) x1 = _x\n      if (_y < y0) y0 = _y\n      if (_y > y1) y1 = _y\n    })\n    return {\n      x: x0 + x,\n      y: y0 + y,\n      w: x1 - x0,\n      h: y1 - y0\n    }\n  }\n\n  constructor (img: HTMLCanvasElement, x: number, y: number, w: number, h: number, rotation: number) {\n    super()\n    this.img = img\n    this.x = x\n    this.y = y\n    this.width = w\n    this.height = h\n    this.rotation = rotation\n  }\n\n  draw (ctx: CanvasRenderingContext2D): void {\n    ctx.translate(this.x, this.y)\n    ctx.rotate(this.rotation)\n    ctx.drawImage(this.img, 0, 0, this.width, this.height)\n  }\n}","import { Canvas } from \"@/modules/canvas/\"\nimport { memo, setting } from \"../../template\"\nimport magicWand from \"@/modules/canvas/utils/magicWand\"\nimport Rasterized from '@/modules/canvas/layer/Rasterized'\n\nlet x: number, y: number\nconst offsetY = 45;\n\nexport default function (cvs: Canvas): void {\n  cvs.on('drop', e => {\n    const ev = e as { x: number, y: number }\n    x = Math.floor(ev.x)\n    y = Math.floor(ev.y - offsetY)\n    \n    const imageData = cvs.ctx.getImageData(0, 0, cvs.width, cvs.height)\n    const res = magicWand(imageData, x, y, 0)\n    let x0 = res[0][0]\n    let x1 = x0\n    let y0 = res[0][1]\n    let y1 = y0\n    res.forEach(([_x, _y]) => {\n      if (x0 === undefined || _x < x0) x0 = _x\n      if (y0 === undefined || _y < y0) y0 = _y\n      if (x1 === undefined || _x > x1) x1 = _x\n      if (y1 === undefined || _y > y1) y1 = _y\n    })\n    const _cvs = document.createElement('canvas')\n    _cvs.width = x1 - x0 + 1\n    _cvs.height = y1 - y0 + 1\n    const _ctx = _cvs.getContext('2d') as CanvasRenderingContext2D;\n    _ctx.fillStyle = setting.pen.color\n    res.forEach(([px, py]) => _ctx.fillRect(px - x0, py - y0, 1, 1))\n    const v = cvs.getRelativeCoord(x0, y0)\n    const w = Math.round((x1 - x0) / cvs.scale)\n    const h = Math.round((y1 - y0) / cvs.scale)\n    const layer = new Rasterized(_cvs, v.x, v.y, w, h, -cvs.rotation)\n    memo.add(layer)\n  })\n}","import { Canvas } from \"@/modules/canvas\";\nimport panzoom from \"./panzoom\";\nimport draw from \"./draw\";\nimport buket from \"./buket\";\n\nexport default function (cvs: Canvas): void {\n  draw(cvs)\n  panzoom(cvs)\n  buket(cvs)\n}","import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, createElementVNode as _createElementVNode, resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, Transition as _Transition, withCtx as _withCtx, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-082e10d6\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"page-wrap flex-v\" }\nconst _hoisted_2 = { key: 0 }\nconst _hoisted_3 = { class: \"drawer-wrap\" }\n\nimport { ref, onMounted, onBeforeMount, provide, markRaw, VueElement } from 'vue'\nimport { cvs, memo, setting } from './index'\nimport Tools from './components/tools/index.vue'\nimport initEvent from './event'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'canvas',\n  props: ['tools'],\n  setup(__props) {\n\n\nconst cvsWrap = ref()\nconst Drawer = ref()\nconst closeDrawer = (): void => { Drawer.value = null }\nlet animateId: number | null = null\n\nconst render = () => {\n  cvs.drawFrame()\n  animateId = window.requestAnimationFrame(render)\n}\n\nprovide('openDrawer', (drawer: VueElement) => Drawer.value = markRaw(drawer))\nprovide('closeDrawer', closeDrawer)\nprovide('cvs', cvs)\nprovide('setting', setting)\nprovide('memo', memo)\n\nonMounted(() => {\n  cvs.mount(cvsWrap.value)\n  initEvent(cvs)\n  render()\n})\n\nonBeforeMount(() => {\n  if (animateId) window.cancelAnimationFrame(animateId)\n})\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _createVNode(Tools, { tools: __props.tools }, null, 8, [\"tools\"]),\n      _createElementVNode(\"div\", {\n        ref_key: \"cvsWrap\",\n        ref: cvsWrap,\n        class: \"flex-main\"\n      }, null, 512)\n    ]),\n    _createVNode(_Transition, { name: \"drawer\" }, {\n      default: _withCtx(() => [\n        (Drawer.value)\n          ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n              _createElementVNode(\"div\", {\n                class: \"modal\",\n                onClick: closeDrawer\n              }),\n              _createElementVNode(\"div\", _hoisted_3, [\n                _createElementVNode(\"span\", {\n                  class: \"closeicon iconfont icon-halfscreen\",\n                  onClick: closeDrawer\n                }),\n                (_openBlock(), _createBlock(_resolveDynamicComponent(Drawer.value)))\n              ])\n            ]))\n          : _createCommentVNode(\"\", true)\n      ]),\n      _: 1\n    })\n  ], 64))\n}\n}\n\n})","import script from \"./canvas.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./canvas.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./canvas.vue?vue&type=style&index=0&id=082e10d6&scoped=true&lang=scss\"\nimport \"./canvas.vue?vue&type=style&index=1&id=082e10d6&lang=css\"\n\nimport exportComponent from \"/Users/baoyukun/Workspace/canvas/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-082e10d6\"]])\n\nexport default __exports__","export default class Coord {\n  x: number;\n  y: number;\n\n  constructor(x: number, y: number) {\n    this.x = x;\n    this.y = y;\n  }\n\n  matrix(\n    a: number,\n    b: number,\n    c: number,\n    d: number,\n    e: number,\n    f: number\n  ): Coord {\n    const x = this.x;\n    const y = this.y;\n    this.x = a * x + b * y + c;\n    this.y = d * x + e * y + f;\n\n    return this;\n  }\n\n  translate(dx: number, dy: number): Coord {\n    this.x += dx;\n    this.y += dy;\n\n    return this;\n  }\n\n  move(dx: number, dy: number): Coord {\n    return this.translate(dx, dy);\n  }\n\n  rotate(a: number): Coord {\n    const c = Math.cos(a);\n    const s = Math.sin(a);\n\n    this.matrix(c, -s, 0, s, c, 0);\n\n    return this;\n  }\n\n  scale(kx: number, ky: number): Coord {\n    this.x *= kx;\n    this.y *= ky;\n    return this;\n  }\n\n  skewX(angle: number): Coord {\n    angle = (angle / 180) * Math.PI;\n    const tan = Math.tan(angle);\n    return this.matrix(1, tan, 0, 0, 1, 0);\n  }\n\n  skewY(angle: number): Coord {\n    angle = (angle / 180) * Math.PI;\n    const tan = Math.tan(angle);\n    return this.matrix(1, 0, 0, tan, 1, 0);\n  }\n\n  norm(): number {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  }\n\n  normalVector(): Coord {\n    const n = this.norm();\n    return n === 0 ? this : new Coord(this.y / n, -this.x / n);\n  }\n\n  unit(): Coord {\n    const n = this.norm();\n    return n === 0 ? this : new Coord(this.x / n, this.y / n);\n  }\n\n  angle (x = 1, y = 0): number {\n    const n = this.norm()\n    const n2 = Math.sqrt(x * x + y * y);\n    if (n * n2 === 0) return 0\n    const d = this.dot(x, y);\n    const cos = Math.max(-1, Math.min(1, d / n / n2))\n    \n    return Math.acos(cos);\n  }\n\n  // 向量内积\n  dot(x: number, y: number): number {\n\n    return this.x * x + this.y * y;\n  }\n\n  // 向量外积\n  cross(x: number, y: number): number {\n    return this.x * y - this.y * x;\n  }\n\n  flip(x0: number, y0: number, x1: number, y1: number): Coord {\n    const { x, y } = this;\n    const [m, n] = [x - x0, y - y0];\n    const [p, q] = [x1 - x0, y1 - y0];\n    if (p !== 0 || q !== 0){\n      const d = p * p + q * q;\n      this.x = (m * (p * p - q * q) + 2 * n * p * q) / d + x0;\n      this.y = (n * (q * q - p * p) + 2 * m * p * q) / d + y0;\n    }\n    return this;\n  }\n}\n","export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=201e08b8&scoped=true&lang=scss\"","export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=2d6942a2&scoped=true&lang=scss\"","export * from \"-!../../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=3d8d9118&scoped=true&lang=scss\"","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=1&id=5b95560c&lang=css\"","export default function (\n  path: number[],\n  ctx: CanvasRenderingContext2D,\n  opt: { size: number, color: string }\n): void {\n  const { size, color } = opt\n  if (path.length === 2) {\n    ctx.beginPath()\n    ctx.arc(path[0], path[1], size / 2, 0, Math.PI * 2)\n    ctx.closePath()\n    ctx.fillStyle = color\n    ctx.fill()\n  } else {\n    ctx.beginPath()\n    ctx.moveTo(path[0], path[1])\n    for (let i = 2; i < path.length; i += 2) {\n      ctx.lineTo(path[i], path[i + 1])\n    }\n    ctx.strokeStyle = color\n    ctx.lineWidth = size\n    ctx.lineCap = 'round'\n    ctx.lineJoin = 'round'\n    ctx.stroke()\n    ctx.closePath()\n  }\n}","export default function (\n  path: number[],\n  ctx: CanvasRenderingContext2D,\n  opt: { size: number, force: number }\n): void {\n  if (path.length < 4) return\n\n  const { size, force } = opt\n  ctx.globalCompositeOperation = 'destination-out'\n  ctx.beginPath()\n  ctx.moveTo(path[0], path[1])\n  for (let i = 2; i < path.length; i += 2) {\n    ctx.lineTo(path[i], path[i + 1])\n  }\n  ctx.strokeStyle = `rgba(255, 255, 255, ${force})`\n  ctx.lineWidth = size\n  ctx.lineCap = 'round'\n  ctx.lineJoin = 'round'\n  ctx.stroke()\n  ctx.closePath()\n}","import { Layer, BoundingBox } from \".\"\nimport { drawPen, drawEraser } from \"../painter\";\n\ninterface Painter {\n  type: 'pen' | 'eraser',\n  size: number,\n  color?: string,\n  force?: number\n}\n\nexport default class Path extends Layer {\n  type = 'Path'\n  painter: {\n    type: 'pen' | 'eraser',\n    size: number,\n    color?: string,\n    force?: number\n  }\n  data: number[] = []\n  _boundingBox?: BoundingBox\n  get boundingBox (): BoundingBox {\n    if (this._boundingBox) return this._boundingBox\n    const s = this.painter.size\n    let x0 = this.data[0];\n    let y0 = this.data[1];\n    let x1 = this.data[0];\n    let y1 = this.data[1];\n    for (let i = 2; i < this.data.length; i += 2) {\n      const x = this.data[i]\n      const y = this.data[i + 1]\n      if (x < x0) x0 = x\n      if (x > x1) x1 = x\n      if (y < y0) y0 = y\n      if (y > y1) y1 = y\n    }\n    this._boundingBox = { x: x0 - s, y: y0 - s, w: x1 - x0 + s * 2, h: y1 - y0 + s * 2 }\n\n    return this._boundingBox\n  }\n\n  constructor (painter: Painter) {\n    super()\n\n    this.painter = painter\n  }\n\n  draw (ctx: CanvasRenderingContext2D): void {\n    const { type, size, color, force } = this.painter\n    if (type === 'pen') {\n      const c = color as string\n      drawPen(this.data, ctx, { size, color: c })\n    } else {\n      const f = force as number\n      drawEraser(this.data, ctx, { size, force: f})\n    }\n  }\n}","import Canvas from '../canvas'\nimport { Layer } from '../layer'\n\nexport default class memo {\n  data: Layer[] = []\n  index = -1\n  cvs: Canvas\n\n  get head () {\n    return this.data.slice(0, this.index + 1)\n  }\n\n  constructor (cvs: Canvas) {\n    this.cvs = cvs\n  }\n\n  reset (): void {\n    this.data = []\n    this.index = -1\n  }\n\n  undo (): void {\n    if (this.index === -1) return\n    this.index--\n    this.cvs.layers = [...this.head]\n    this.cvs.refreshImage()\n  }\n\n  redo (): void {\n    if (this.index === this.data.length - 1) return\n    this.index++\n    this.cvs.layers = [...this.head]\n    this.cvs.refreshImage()\n  }\n\n  add (path: Layer): void {\n    this.data.splice(this.index + 1)\n    this.data.push(path)\n    this.cvs.layers.push(path)\n    this.cvs.refreshImage()\n    this.index++\n  }\n}","import Canvas from \"../canvas\"\n\nexport default function (cvs: Canvas): void {\n  const touchstart = (e: TouchEvent): void => {\n    e.preventDefault()\n    cvs.emit('touchstart', e)\n  }\n  const touchmove = (e: TouchEvent): void => {\n    e.preventDefault()\n    cvs.emit('touchmove', e)\n  }\n  const touchend = (e: TouchEvent): void => {\n    e.preventDefault()\n    cvs.emit('touchend', e)\n  }\n  cvs.dom.addEventListener('touchstart', touchstart)\n  cvs.dom.addEventListener('touchmove', touchmove)\n  cvs.dom.addEventListener('touchend', touchend)\n}","import { Layer } from \"./layer\"\nimport initEvent from './event'\nimport Coord from \"../coord\";\n\ninterface CB {\n  (...args: unknown[]): void\n}\n\nexport default class Canvas {\n  x = 0;\n  y = 0;\n  scale = 1;\n  rotation = 0;\n  mode = 'default'\n  backgroundColor = 'rgba(255, 255, 255, 1)'\n  width = 400\n  height = 300\n  layers: Layer[] = []\n  activePath: Layer | null = null\n  dom: HTMLCanvasElement\n  ctx: CanvasRenderingContext2D\n  activeCanvas: HTMLCanvasElement\n  activeCtx: CanvasRenderingContext2D\n  img: {\n    x: number,\n    y: number,\n    w: number,\n    h: number,\n    img: HTMLCanvasElement\n  } | null = null\n\n  private handlers: Record<string, CB[]> = {}\n\n  constructor () {\n    this.dom = this.initDom()\n    this.ctx = this.dom.getContext('2d', { willReadFrequently: true }) as CanvasRenderingContext2D\n    this.activeCanvas = document.createElement('canvas')\n    this.activeCanvas.width = this.width\n    this.activeCanvas.height = this.height\n    this.activeCtx = this.activeCanvas.getContext('2d') as CanvasRenderingContext2D\n    initEvent(this)\n  }\n\n  initDom (): HTMLCanvasElement {\n    const cvs = document.createElement('canvas')\n  \n    cvs.width = this.width\n    cvs.height = this.height\n    Object.assign(cvs.style, {\n      width: this.width + 'px',\n      height: this.height + 'px',\n      verticalAlign: 'middle',\n    })\n\n    return cvs\n  }\n\n  mount (dom: HTMLElement): void {\n    dom.appendChild(this.dom)\n    const w = dom.offsetWidth\n    const h = dom.offsetHeight\n\n    this.resize(w, h)\n  }\n\n  resize (w: number, h: number): void {\n    this.width = w\n    this.height = h\n    this.dom.width = w\n    this.dom.height = h\n    this.dom.style.width = w + 'px'\n    this.dom.style.height = h + 'px'\n    this.activeCanvas.width = w\n    this.activeCanvas.height = h\n    this.activeCanvas.style.width = w + 'px'\n    this.activeCanvas.style.height = h + 'px'\n  }\n\n  refreshImage (): void {\n    const { x, y, w, h } = this.getBoundingBox()\n    if (w === 0 || h === 0) {\n      this.img = null\n      return\n    }\n\n    const cvs = document.createElement('canvas')\n    cvs.width = w\n    cvs.height = h\n    const ctx = cvs.getContext('2d') as CanvasRenderingContext2D\n    ctx.translate(-x, -y)\n    this.layers.forEach(layer => {\n      ctx.save()\n      layer.draw(ctx)\n      ctx.restore()\n    })\n\n    this.img = { x, y, w, h, img: cvs }\n  }\n\n  getBoundingBox (): { x: number, y: number, w: number, h: number} {\n    if (this.layers.length === 0) {\n      return { x: 0, y: 0, w: 0, h: 0 }\n    } else {\n      let s = 1\n      const rs = this.layers.map(l => {\n        const _s = (<any>l)?.painter?.size || 0\n        _s > s && (s = _s)\n        return l.boundingBox\n      })\n      let { x: x0, y: y0 } = rs[0]\n      const { w, h } = rs[0]\n      let x1 = x0 + w\n      let y1 = y0 + h\n\n      for (let i = 1; i < rs.length; i++) {\n        const { x, y, w: _w, h: _h} = rs[i]\n        if (x < x0) x0 = x\n        if (y < y0) y0 = y\n        if (x + _w > x1) x1 = x + _w\n        if (y + _h > y1) y1 = y + _h\n      }\n      return { x: x0 - s, y: y0 - s, w: x1 - x0 + s, h: y1 - y0 + s }\n    }\n  }\n\n  drawFrame (): void {\n    const {\n      x,\n      y,\n      scale,\n      width,\n      height,\n      activeCtx: ctx,\n      rotation,\n      backgroundColor,\n      img\n    } = this\n\n    ctx.clearRect(0, 0, width, height)\n    ctx.save()\n    ctx.translate(x, y)\n    ctx.scale(scale, scale)\n    ctx.rotate(rotation)\n    this.emit('beforeRender', ctx)\n    this.layers.forEach(layer => {\n      ctx.save()\n      layer.draw(ctx)\n      ctx.restore()\n    })\n    // img && ctx.drawImage(img.img, img.x, img.y, img.w, img.h)\n    if (this.activePath) this.activePath.draw(ctx)\n    ctx.restore()\n\n    this.ctx.clearRect(0, 0, width, height)\n    this.ctx.fillStyle = backgroundColor\n    this.ctx.fillRect(0, 0, width, height)\n    this.ctx.drawImage(this.activeCanvas, 0, 0, width, height)\n  }\n\n  getRelativeCoord (x: number, y: number): Coord {\n    return new Coord(x, y)\n      .translate(-this.x, -this.y)\n      .scale(1 / this.scale, 1 / this.scale)\n      .rotate(-this.rotation)\n  }\n\n  on (eventType: string, eventHandler: CB): void {\n    if (!this.handlers[eventType]) {\n      this.handlers[eventType] = []\n    }\n    const handlers = this.handlers[eventType]\n    handlers.push(eventHandler)\n  }\n\n  off (eventType: string, eventHandler?: CB): void {\n    if (!this.handlers[eventType]) return\n    if (!eventHandler) {\n      this.handlers[eventType] = []\n      return\n    }\n\n    const handlers = this.handlers[eventType]\n    const i = handlers.indexOf(eventHandler)\n\n    if (i > -1) handlers.splice(i, 1)\n  }\n\n  emit (eventType: string, ...args: unknown[]): void {\n    const handlers = this.handlers[eventType]\n    if (!handlers || handlers.length === 0) return\n\n    handlers.forEach(cb => cb(...args))\n  }\n}","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./canvas.vue?vue&type=style&index=1&id=082e10d6&lang=css\"","export interface BoundingBox {\n  x: number,\n  y: number,\n  w: number,\n  h: number\n}\n\nexport abstract class Layer {\n  abstract readonly type: string;\n  abstract draw (ctx: CanvasRenderingContext2D): void\n  abstract _boundingBox?: BoundingBox\n  abstract get boundingBox(): BoundingBox\n}","import { reactive } from 'vue'\nimport { Canvas, Memo } from '@/modules/canvas'\n\nconst cvs = new Canvas()\nconst memo = new Memo(cvs)\nconst setting = reactive({\n  mode: 'pen',\n  buket: false,\n  pen: {\n    color: '#000',\n    size: 1,\n  },\n  eraser: {\n    size: 1,\n    force: 1\n  }\n})\n\nexport { cvs, memo, setting }","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./canvas.vue?vue&type=style&index=0&id=082e10d6&scoped=true&lang=scss\"","export * from \"-!../../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=7f8b0450&scoped=true&lang=scss\"","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=5b95560c&scoped=true&lang=scss\""],"sourceRoot":""}