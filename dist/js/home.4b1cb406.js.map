{"version":3,"sources":["webpack:///./src/views/home/components/tools/index.vue?9ec7","webpack:///./src/views/home/components/tools/export/drawer/index.vue?5ebd","webpack:///./src/modules/canvas/layer/index.ts","webpack:///./src/modules/canvas/painter/pen.ts","webpack:///./src/modules/canvas/painter/eraser.ts","webpack:///./src/modules/canvas/layer/path.ts","webpack:///./src/modules/canvas/utils/memo.ts","webpack:///./src/modules/canvas/event/index.ts","webpack:///./src/modules/coord/index.ts","webpack:///./src/modules/canvas/canvas.ts","webpack:///./src/views/home/index.ts","webpack:///./src/views/home/components/tools/pen/index.vue","webpack:///./src/views/home/components/tools/pen/index.vue?4749","webpack:///./src/views/home/components/tools/size/drawer/index.vue","webpack:///./src/views/home/components/tools/size/drawer/index.vue?873f","webpack:///./src/views/home/components/tools/size/index.vue","webpack:///./src/views/home/components/tools/size/index.vue?4e0a","webpack:///./src/views/home/components/tools/color/index.vue","webpack:///./src/views/home/components/tools/color/index.vue?aa0b","webpack:///./src/views/home/components/tools/undo/index.vue","webpack:///./src/views/home/components/tools/undo/index.vue?0058","webpack:///./src/views/home/components/tools/redo/index.vue","webpack:///./src/views/home/components/tools/redo/index.vue?e2b9","webpack:///./src/views/home/components/tools/clear/index.vue","webpack:///./src/views/home/components/tools/clear/index.vue?35be","webpack:///./src/views/home/components/tools/export/drawer/index.vue","webpack:///./src/views/home/components/tools/export/drawer/index.vue?d6fb","webpack:///./src/views/home/components/tools/export/index.vue","webpack:///./src/views/home/components/tools/export/index.vue?573d","webpack:///./src/views/home/components/tools/resetViewport/index.vue","webpack:///./src/views/home/components/tools/resetViewport/index.vue?1903","webpack:///./src/views/home/components/tools/more/index.vue","webpack:///./src/views/home/components/tools/more/index.vue?7b4d","webpack:///./src/views/home/components/tools/index.vue","webpack:///./src/views/home/components/tools/index.vue?0395","webpack:///./src/views/home/event/panzoom.ts","webpack:///./src/views/home/event/draw.ts","webpack:///./src/modules/canvas/utils/magicWand.ts","webpack:///./src/modules/canvas/layer/Rasterized.ts","webpack:///./src/views/home/event/buket.ts","webpack:///./src/views/home/event/index.ts","webpack:///./src/views/home/index.vue","webpack:///./src/views/home/index.vue?2e04","webpack:///./src/views/home/index.vue?d6df","webpack:///./src/views/home/components/tools/size/index.vue?7d40","webpack:///./src/views/home/components/tools/size/drawer/index.vue?641b","webpack:///./src/views/home/components/tools/index.vue?55ad","webpack:///./src/views/home/components/tools/more/index.vue?ab55","webpack:///./src/views/home/index.vue?722f"],"names":["Layer","path","ctx","opt","size","color","length","beginPath","arc","Math","PI","closePath","fillStyle","fill","moveTo","i","lineTo","strokeStyle","lineWidth","lineCap","lineJoin","stroke","force","globalCompositeOperation","Path","constructor","painter","super","type","data","this","_boundingBox","s","x0","y0","x1","y1","x","y","w","h","draw","c","drawPen","f","drawEraser","memo","cvs","index","slice","reset","undo","layers","head","refreshImage","redo","add","splice","push","touchstart","e","preventDefault","emit","touchmove","touchend","dom","addEventListener","Coord","matrix","a","b","d","translate","dx","dy","move","rotate","cos","sin","scale","kx","ky","skewX","angle","tan","skewY","norm","sqrt","normalVector","n","unit","n2","dot","max","min","acos","cross","flip","m","p","q","Canvas","rotation","mode","backgroundColor","width","height","activePath","img","handlers","initDom","getContext","willReadFrequently","activeCanvas","document","createElement","activeCtx","body","appendChild","initEvent","Object","assign","style","verticalAlign","mount","offsetWidth","offsetHeight","resize","getBoundingBox","forEach","layer","save","restore","rs","map","l","_s","boundingBox","_w","_h","drawFrame","clearRect","fillRect","drawImage","getRelativeCoord","on","eventType","eventHandler","off","indexOf","args","cb","Memo","setting","reactive","buket","pen","eraser","_hoisted_1","_defineComponent","__name","setup","__props","pens","name","icon","setPainter","_ctx","_cache","_openBlock","_createElementBlock","_Fragment","_renderList","_createElementVNode","key","class","_normalizeClass","_unref","onClick","$event","__exports__","_withScopeId","_pushScopeId","_popScopeId","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","sizes","ref","setSize","v","value","_component_el_slider","_resolveComponent","_normalizeStyle","_createVNode","modelValue","onChange","openDrawer","inject","Drawer","predefined","setPredefined","includes","unshift","drag","touches","pageX","pageY","dragend","window","removeEventListener","elementFromPoint","_component_el_color_picker","onTouchstart","predefine","_createTextVNode","clear","src","toDataURL","resetViewport","background","showBg","setTimeout","show","_component_el_dropdown_item","_component_el_dropdown_menu","_component_el_dropdown","placement","dropdown","_withCtx","default","_","ResetViewport","Export","divided","Clear","ref_key","Pen","Size","Color","Undo","Redo","MoreOptions","ev","_x0","_y0","_x1","_y1","_v","ang","k","c0","c1","moved","offsetY","magicWand","imageData","px","py","threshold","distance","p1","p2","sum","abs","checked","Set","res","p0","check","has","ps","_x","_y","floor","getImageData","undefined","_cvs","round","Rasterized","panzoom","cvsWrap","closeDrawer","animateId","render","requestAnimationFrame","provide","drawer","markRaw","onMounted","onBeforeMount","cancelAnimationFrame","Tools","onGesturestart","_withModifiers","_Transition","_createBlock","_resolveDynamicComponent","_createCommentVNode"],"mappings":"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","file":"js/home.4b1cb406.js","sourcesContent":["export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=347cc8d6&scoped=true&lang=scss\"","export * from \"-!../../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=1de6035a&scoped=true&lang=scss\"","export interface BoundingBox {\n  x: number,\n  y: number,\n  w: number,\n  h: number\n}\n\nexport abstract class Layer {\n  abstract readonly type: string;\n  abstract draw (ctx: CanvasRenderingContext2D): void\n  abstract _boundingBox?: BoundingBox\n  abstract get boundingBox(): BoundingBox\n}","export default function (\n  path: number[],\n  ctx: CanvasRenderingContext2D,\n  opt: { size: number, color: string }\n): void {\n  const { size, color } = opt\n  if (path.length === 2) {\n    ctx.beginPath()\n    ctx.arc(path[0], path[1], size / 2, 0, Math.PI * 2)\n    ctx.closePath()\n    ctx.fillStyle = color\n    ctx.fill()\n  } else {\n    ctx.beginPath()\n    ctx.moveTo(path[0], path[1])\n    for (let i = 2; i < path.length; i += 2) {\n      ctx.lineTo(path[i], path[i + 1])\n    }\n    ctx.strokeStyle = color\n    ctx.lineWidth = size\n    ctx.lineCap = 'round'\n    ctx.lineJoin = 'round'\n    ctx.stroke()\n    ctx.closePath()\n  }\n}","export default function (\n  path: number[],\n  ctx: CanvasRenderingContext2D,\n  opt: { size: number, force: number }\n): void {\n  if (path.length < 4) return\n\n  const { size, force } = opt\n  ctx.globalCompositeOperation = 'destination-out'\n  ctx.beginPath()\n  ctx.moveTo(path[0], path[1])\n  for (let i = 2; i < path.length; i += 2) {\n    ctx.lineTo(path[i], path[i + 1])\n  }\n  ctx.strokeStyle = `rgba(255, 255, 255, ${force})`\n  ctx.lineWidth = size\n  ctx.lineCap = 'round'\n  ctx.lineJoin = 'round'\n  ctx.stroke()\n  ctx.closePath()\n}","import { Layer, BoundingBox } from \".\"\nimport { drawPen, drawEraser } from \"../painter\";\n\ninterface Painter {\n  type: 'pen' | 'eraser',\n  size: number,\n  color?: string,\n  force?: number\n}\n\nexport default class Path extends Layer {\n  type = 'Path'\n  painter: {\n    type: 'pen' | 'eraser',\n    size: number,\n    color?: string,\n    force?: number\n  }\n  data: number[] = []\n  _boundingBox?: BoundingBox\n  get boundingBox (): BoundingBox {\n    if (this._boundingBox) return this._boundingBox\n    const s = this.painter.size\n    let x0 = this.data[0];\n    let y0 = this.data[1];\n    let x1 = this.data[0];\n    let y1 = this.data[1];\n    for (let i = 2; i < this.data.length; i += 2) {\n      const x = this.data[i]\n      const y = this.data[i + 1]\n      if (x < x0) x0 = x\n      if (x > x1) x1 = x\n      if (y < y0) y0 = y\n      if (y > y1) y1 = y\n    }\n    this._boundingBox = { x: x0 - s, y: y0 - s, w: x1 - x0 + s * 2, h: y1 - y0 + s * 2 }\n\n    return this._boundingBox\n  }\n\n  constructor (painter: Painter) {\n    super()\n\n    this.painter = painter\n  }\n\n  draw (ctx: CanvasRenderingContext2D): void {\n    const { type, size, color, force } = this.painter\n    if (type === 'pen') {\n      const c = color as string\n      drawPen(this.data, ctx, { size, color: c })\n    } else {\n      const f = force as number\n      drawEraser(this.data, ctx, { size, force: f})\n    }\n  }\n}","import Canvas from '../canvas'\nimport { Layer } from '../layer'\n\nexport default class memo {\n  data: Layer[] = []\n  index = -1\n  cvs: Canvas\n\n  get head () {\n    return this.data.slice(0, this.index + 1)\n  }\n\n  constructor (cvs: Canvas) {\n    this.cvs = cvs\n  }\n\n  reset (): void {\n    this.data = []\n    this.index = -1\n  }\n\n  undo (): void {\n    if (this.index === -1) return\n    this.index--\n    this.cvs.layers = [...this.head]\n    this.cvs.refreshImage()\n  }\n\n  redo (): void {\n    if (this.index === this.data.length - 1) return\n    this.index++\n    this.cvs.layers = [...this.head]\n    this.cvs.refreshImage()\n  }\n\n  add (path: Layer): void {\n    this.data.splice(this.index + 1)\n    this.data.push(path)\n    this.cvs.layers.push(path)\n    this.cvs.refreshImage()\n    this.index++\n  }\n}","import Canvas from \"../canvas\"\n\nexport default function (cvs: Canvas): void {\n  const touchstart = (e: TouchEvent): void => {\n    e.preventDefault()\n    cvs.emit('touchstart', e)\n  }\n  const touchmove = (e: TouchEvent): void => {\n    e.preventDefault()\n    cvs.emit('touchmove', e)\n  }\n  const touchend = (e: TouchEvent): void => {\n    e.preventDefault()\n    cvs.emit('touchend', e)\n  }\n  cvs.dom.addEventListener('touchstart', touchstart)\n  cvs.dom.addEventListener('touchmove', touchmove)\n  cvs.dom.addEventListener('touchend', touchend)\n}","export default class Coord {\n  x: number;\n  y: number;\n\n  constructor(x: number, y: number) {\n    this.x = x;\n    this.y = y;\n  }\n\n  matrix(\n    a: number,\n    b: number,\n    c: number,\n    d: number,\n    e: number,\n    f: number\n  ): Coord {\n    const x = this.x;\n    const y = this.y;\n    this.x = a * x + b * y + c;\n    this.y = d * x + e * y + f;\n\n    return this;\n  }\n\n  translate(dx: number, dy: number): Coord {\n    this.x += dx;\n    this.y += dy;\n\n    return this;\n  }\n\n  move(dx: number, dy: number): Coord {\n    return this.translate(dx, dy);\n  }\n\n  rotate(a: number): Coord {\n    const c = Math.cos(a);\n    const s = Math.sin(a);\n\n    this.matrix(c, -s, 0, s, c, 0);\n\n    return this;\n  }\n\n  scale(kx: number, ky: number): Coord {\n    this.x *= kx;\n    this.y *= ky;\n    return this;\n  }\n\n  skewX(angle: number): Coord {\n    angle = (angle / 180) * Math.PI;\n    const tan = Math.tan(angle);\n    return this.matrix(1, tan, 0, 0, 1, 0);\n  }\n\n  skewY(angle: number): Coord {\n    angle = (angle / 180) * Math.PI;\n    const tan = Math.tan(angle);\n    return this.matrix(1, 0, 0, tan, 1, 0);\n  }\n\n  norm(): number {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  }\n\n  normalVector(): Coord {\n    const n = this.norm();\n    return n === 0 ? this : new Coord(this.y / n, -this.x / n);\n  }\n\n  unit(): Coord {\n    const n = this.norm();\n    return n === 0 ? this : new Coord(this.x / n, this.y / n);\n  }\n\n  angle (x = 1, y = 0): number {\n    const n = this.norm()\n    const n2 = Math.sqrt(x * x + y * y);\n    if (n * n2 === 0) return 0\n    const d = this.dot(x, y);\n    const cos = Math.max(-1, Math.min(1, d / n / n2))\n    \n    return Math.acos(cos);\n  }\n\n  // 向量内积\n  dot(x: number, y: number): number {\n\n    return this.x * x + this.y * y;\n  }\n\n  // 向量外积\n  cross(x: number, y: number): number {\n    return this.x * y - this.y * x;\n  }\n\n  flip(x0: number, y0: number, x1: number, y1: number): Coord {\n    const { x, y } = this;\n    const [m, n] = [x - x0, y - y0];\n    const [p, q] = [x1 - x0, y1 - y0];\n    if (p !== 0 || q !== 0){\n      const d = p * p + q * q;\n      this.x = (m * (p * p - q * q) + 2 * n * p * q) / d + x0;\n      this.y = (n * (q * q - p * p) + 2 * m * p * q) / d + y0;\n    }\n    return this;\n  }\n}\n","import { Layer } from \"./layer\"\nimport initEvent from './event'\nimport Coord from \"../coord\";\n\ninterface CB {\n  (...args: unknown[]): void\n}\n\nexport default class Canvas {\n  x = 0;\n  y = 0;\n  scale = 1;\n  rotation = 0;\n  mode = 'default'\n  backgroundColor = 'rgba(255, 255, 255, 1)'\n  width = 400\n  height = 300\n  layers: Layer[] = []\n  activePath: Layer | null = null\n  dom: HTMLCanvasElement\n  ctx: CanvasRenderingContext2D\n  activeCanvas: HTMLCanvasElement\n  activeCtx: CanvasRenderingContext2D\n  img: {\n    x: number,\n    y: number,\n    w: number,\n    h: number,\n    img: HTMLCanvasElement\n  } | null = null\n\n  private handlers: Record<string, CB[]> = {}\n\n  constructor () {\n    this.dom = this.initDom()\n    this.ctx = this.dom.getContext('2d', { willReadFrequently: true }) as CanvasRenderingContext2D\n    this.activeCanvas = document.createElement('canvas')\n    this.activeCanvas.width = this.width\n    this.activeCanvas.height = this.height\n    this.activeCtx = this.activeCanvas.getContext('2d') as CanvasRenderingContext2D\n    document.body.appendChild(this.activeCanvas)\n    initEvent(this)\n  }\n\n  initDom (): HTMLCanvasElement {\n    const cvs = document.createElement('canvas')\n  \n    cvs.width = this.width\n    cvs.height = this.height\n    Object.assign(cvs.style, {\n      width: this.width + 'px',\n      height: this.height + 'px',\n      verticalAlign: 'middle',\n    })\n\n    return cvs\n  }\n\n  mount (dom: HTMLElement): void {\n    dom.appendChild(this.dom)\n    const w = dom.offsetWidth\n    const h = dom.offsetHeight\n\n    this.resize(w, h)\n  }\n\n  resize (w: number, h: number): void {\n    this.width = w\n    this.height = h\n    this.dom.width = w\n    this.dom.height = h\n    this.dom.style.width = w + 'px'\n    this.dom.style.height = h + 'px'\n    this.activeCanvas.width = w\n    this.activeCanvas.height = h\n    this.activeCanvas.style.width = w + 'px'\n    this.activeCanvas.style.height = h + 'px'\n  }\n\n  refreshImage (): void {\n    const { x, y, w, h } = this.getBoundingBox()\n    if (w === 0 || h === 0) {\n      this.img = null\n      return\n    }\n\n    const cvs = document.createElement('canvas')\n    cvs.width = w\n    cvs.height = h\n    const ctx = cvs.getContext('2d') as CanvasRenderingContext2D\n    ctx.translate(-x, -y)\n    this.layers.forEach(layer => {\n      ctx.save()\n      layer.draw(ctx)\n      ctx.restore()\n    })\n\n    this.img = { x, y, w, h, img: cvs }\n  }\n\n  getBoundingBox (): { x: number, y: number, w: number, h: number} {\n    if (this.layers.length === 0) {\n      return { x: 0, y: 0, w: 0, h: 0 }\n    } else {\n      let s = 1\n      const rs = this.layers.map(l => {\n        const _s = (<any>l)?.painter?.size || 0\n        _s > s && (s = _s)\n        return l.boundingBox\n      })\n      let { x: x0, y: y0 } = rs[0]\n      const { w, h } = rs[0]\n      let x1 = x0 + w\n      let y1 = y0 + h\n\n      for (let i = 1; i < rs.length; i++) {\n        const { x, y, w: _w, h: _h} = rs[i]\n        if (x < x0) x0 = x\n        if (y < y0) y0 = y\n        if (x + _w > x1) x1 = x + _w\n        if (y + _h > y1) y1 = y + _h\n      }\n      return { x: x0 - s, y: y0 - s, w: x1 - x0 + s, h: y1 - y0 + s }\n    }\n  }\n\n  drawFrame (): void {\n    const {\n      x,\n      y,\n      scale,\n      width,\n      height,\n      activeCtx: ctx,\n      rotation,\n      backgroundColor,\n      img\n    } = this\n\n    ctx.clearRect(0, 0, width, height)\n    ctx.save()\n    ctx.translate(x, y)\n    ctx.scale(scale, scale)\n    ctx.rotate(rotation)\n    this.layers.forEach(layer => {\n      ctx.save()\n      layer.draw(ctx)\n      ctx.restore()\n    })\n    // img && ctx.drawImage(img.img, img.x, img.y, img.w, img.h)\n    if (this.activePath) this.activePath.draw(ctx)\n    ctx.restore()\n\n    this.ctx.clearRect(0, 0, width, height)\n    this.ctx.fillStyle = backgroundColor\n    this.ctx.fillRect(0, 0, width, height)\n    this.ctx.drawImage(this.activeCanvas, 0, 0, width, height)\n  }\n\n  getRelativeCoord (x: number, y: number): Coord {\n    return new Coord(x, y)\n      .translate(-this.x, -this.y)\n      .scale(1 / this.scale, 1 / this.scale)\n      .rotate(-this.rotation)\n  }\n\n  on (eventType: string, eventHandler: CB): void {\n    if (!this.handlers[eventType]) {\n      this.handlers[eventType] = []\n    }\n    const handlers = this.handlers[eventType]\n    handlers.push(eventHandler)\n  }\n\n  off (eventType: string, eventHandler?: CB): void {\n    if (!this.handlers[eventType]) return\n    if (!eventHandler) {\n      this.handlers[eventType] = []\n      return\n    }\n\n    const handlers = this.handlers[eventType]\n    const i = handlers.indexOf(eventHandler)\n\n    if (i > -1) handlers.splice(i, 1)\n  }\n\n  emit (eventType: string, ...args: unknown[]): void {\n    const handlers = this.handlers[eventType]\n    if (!handlers || handlers.length === 0) return\n\n    handlers.forEach(cb => cb(...args))\n  }\n}","import { reactive } from 'vue'\nimport { Canvas, Memo } from '@/modules/canvas'\n\nconst cvs = new Canvas()\nconst memo = new Memo(cvs)\nconst setting = reactive({\n  mode: 'pen',\n  buket: false,\n  pen: {\n    color: '#000',\n    size: 1,\n  },\n  eraser: {\n    size: 1,\n    force: 1\n  }\n})\n\nexport { cvs, memo, setting }","import { defineComponent as _defineComponent } from 'vue'\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, unref as _unref, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode } from \"vue\"\n\nconst _hoisted_1 = [\"onClick\"]\n\nimport { setting } from '../../../index'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst pens = [\n  { name: 'pen', icon: 'icon-pen1' },\n  { name: 'eraser', icon: 'icon-eraser' },\n]\nconst setPainter = (painter: string) => {\n  setting.mode = painter\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(_Fragment, null, _renderList(pens, (p, i) => {\n    return _createElementVNode(\"span\", {\n      key: i,\n      class: _normalizeClass([\"iconfont\", p.name === _unref(setting).mode ? \"is-active \" + p.icon : p.icon]),\n      onClick: ($event: any) => (setPainter(p.name))\n    }, null, 10, _hoisted_1)\n  }), 64))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle, resolveComponent as _resolveComponent, createVNode as _createVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-2845444e\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"panel\" }\nconst _hoisted_2 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"panel-header\" }, \" 粗细 \", -1))\nconst _hoisted_3 = { class: \"panel-body\" }\nconst _hoisted_4 = { class: \"size-wrap flex\" }\nconst _hoisted_5 = [\"onClick\"]\nconst _hoisted_6 = { class: \"panel-body\" }\n\nimport { ref } from 'vue'\nimport { setting } from '../../../..'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst sizes = [1, 5, 10, 15, 20, 25]\nconst size = ref(setting.mode === 'pen' ? setting.pen.size : setting.eraser.size)\nconst setSize = (v: number) => {\n  size.value = v\n  if (setting.mode === 'pen') {\n    setting.pen.size = v\n  } else {\n    setting.eraser.size = v\n  }\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_slider = _resolveComponent(\"el-slider\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _hoisted_2,\n    _createElementVNode(\"div\", _hoisted_3, [\n      _createElementVNode(\"div\", _hoisted_4, [\n        (_openBlock(), _createElementBlock(_Fragment, null, _renderList(sizes, (s) => {\n          return _createElementVNode(\"span\", {\n            class: \"size\",\n            key: s,\n            onClick: ($event: any) => (setSize(s))\n          }, [\n            _createElementVNode(\"span\", {\n              class: \"size-inner\",\n              style: _normalizeStyle({\n              width: s + 'px',\n              height: s + 'px',\n            })\n            }, null, 4)\n          ], 8, _hoisted_5)\n        }), 64))\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_6, [\n      _createVNode(_component_el_slider, {\n        modelValue: size.value,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((size).value = $event)),\n        onChange: setSize,\n        min: 1,\n        max: 50\n      }, null, 8, [\"modelValue\"])\n    ])\n  ]))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=2845444e&scoped=true&lang=scss\"\n\nimport exportComponent from \"/Users/baoyukun/Workspace/canvas/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2845444e\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-92ac15c6\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", { class: \"sizeicon\" }, null, -1))\nconst _hoisted_2 = [\n  _hoisted_1\n]\n\nimport { inject } from 'vue'\nimport Drawer from './drawer/index.vue'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst openDrawer = inject('openDrawer')\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"span\", {\n    class: \"iconfont\",\n    onClick: _cache[0] || (_cache[0] = ($event: any) => (_unref(openDrawer)(Drawer)))\n  }, _hoisted_2))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=92ac15c6&scoped=true&lang=scss\"\n\nimport exportComponent from \"/Users/baoyukun/Workspace/canvas/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-92ac15c6\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport { ref } from 'vue';\nimport { cvs, setting } from '../../../index'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst predefined = ref<string[]>([])\nconst setPredefined = (c: string) => {\n  if (c === null) {\n    c = setting.pen.color = 'rgba(0, 0, 0, 1)'\n  }\n\n  if (predefined.value.includes(c)) return\n\n  predefined.value.unshift(c)\n}\n\nconst drag = (e: TouchEvent) => {\n  if (e.touches.length > 1) return\n  let x = e.touches[0].pageX\n  let y = e.touches[0].pageY\n\n  const drag = (e: TouchEvent) => {\n    x = e.touches[0].pageX\n    y = e.touches[0].pageY\n  }\n\n  const dragend = (): void => {\n    window.removeEventListener('touchend', dragend)\n    window.removeEventListener('touchmove', drag)\n\n    if (document.elementFromPoint(x, y) === cvs.dom) {\n      cvs.emit('drop', { x, y })\n    }\n  }\n\n  window.addEventListener('touchmove', drag)\n  window.addEventListener('touchend', dragend)\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_color_picker = _resolveComponent(\"el-color-picker\")!\n\n  return (_openBlock(), _createElementBlock(\"span\", { onTouchstart: drag }, [\n    _createVNode(_component_el_color_picker, {\n      class: \"color-picker\",\n      modelValue: _unref(setting).pen.color,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_unref(setting).pen.color) = $event)),\n      onChange: setPredefined,\n      \"show-alpha\": \"\",\n      predefine: predefined.value\n    }, null, 8, [\"modelValue\", \"predefine\"])\n  ], 32))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport { memo } from '../../..'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst undo = () => memo.undo()\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"span\", {\n    class: \"iconfont icon-Undo\",\n    onClick: undo\n  }))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport { memo } from '../../..'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst redo = () => memo.redo()\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"span\", {\n    class: \"iconfont icon-Redo\",\n    onClick: redo\n  }))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"span\", { class: \"iconfont icon-delete\" }, null, -1)\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\" 清除屏幕 \")\nconst _hoisted_3 = [\n  _hoisted_1,\n  _hoisted_2\n]\n\nimport { memo, cvs } from '../../../index'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst clear = () => {\n  cvs.layers = []\n  memo.reset()\n  cvs.refreshImage()\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"span\", {\n    style: {\"color\":\"red\"},\n    onClick: clear\n  }, _hoisted_3))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-1de6035a\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, \"长按保存图片\", -1))\nconst _hoisted_2 = { class: \"img-wrap\" }\nconst _hoisted_3 = [\"src\"]\n\nimport { inject } from 'vue'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst cvs = inject('cvs')\nconst src = cvs.dom.toDataURL()\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _hoisted_1,\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"img\", { src: _unref(src) }, null, 8, _hoisted_3)\n    ])\n  ], 64))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=1de6035a&scoped=true&lang=scss\"\n\nimport exportComponent from \"/Users/baoyukun/Workspace/canvas/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1de6035a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, unref as _unref, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"span\", { class: \"iconfont icon-download\" }, null, -1)\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\"导出图片 \")\nconst _hoisted_3 = [\n  _hoisted_1,\n  _hoisted_2\n]\n\nimport { inject } from 'vue'\nimport Drawer from './drawer/index.vue'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst openDrawer = inject('openDrawer')\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"span\", {\n    onClick: _cache[0] || (_cache[0] = ($event: any) => (_unref(openDrawer)(Drawer)))\n  }, _hoisted_3))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"span\", { class: \"iconfont icon-marquee\" }, null, -1)\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\"重置视口 \")\nconst _hoisted_3 = [\n  _hoisted_1,\n  _hoisted_2\n]\n\nimport { cvs } from '../../../index'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst resetViewport = (): void => {\n  cvs.x = 0\n  cvs.y = 0\n  cvs.scale = 1\n  cvs.rotation = 0\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"span\", { onClick: resetViewport }, _hoisted_3))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, unref as _unref, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-2707072a\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", { class: \"iconfont icon-menu\" }, null, -1))\nconst _hoisted_2 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", { class: \"iconfont icon-background-f\" }, null, -1))\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\" 背景颜色 \")\nconst _hoisted_4 = { class: \"picker\" }\n\nimport { ref } from 'vue';\nimport Clear from '../clear/index.vue'\nimport Export from '../export/index.vue'\nimport ResetViewport from '../resetViewport/index.vue';\nimport { cvs } from '../../..'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst predefine = ref<string[]>([])\nconst setPredefined = (c: string) => {\n  if (c === null) {\n    c = cvs.backgroundColor = 'rgba(255,255,255, 1)'\n  }\n\n  if (predefine.value.includes(c)) return\n\n  predefine.value.unshift(c)\n}\n\nconst background = ref()\nconst showBg = () => {\n  setTimeout(() => {\n    background.value.show()\n  }, 200)\n}\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_dropdown_item = _resolveComponent(\"el-dropdown-item\")!\n  const _component_el_dropdown_menu = _resolveComponent(\"el-dropdown-menu\")!\n  const _component_el_dropdown = _resolveComponent(\"el-dropdown\")!\n  const _component_el_color_picker = _resolveComponent(\"el-color-picker\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createVNode(_component_el_dropdown, { placement: \"top\" }, {\n      dropdown: _withCtx(() => [\n        _createVNode(_component_el_dropdown_menu, null, {\n          default: _withCtx(() => [\n            _createVNode(_component_el_dropdown_item, { onClick: showBg }, {\n              default: _withCtx(() => [\n                _hoisted_2,\n                _hoisted_3\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_el_dropdown_item, null, {\n              default: _withCtx(() => [\n                _createVNode(ResetViewport)\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_el_dropdown_item, null, {\n              default: _withCtx(() => [\n                _createVNode(Export)\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_el_dropdown_item, { divided: \"\" }, {\n              default: _withCtx(() => [\n                _createVNode(Clear)\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        })\n      ]),\n      default: _withCtx(() => [\n        _hoisted_1\n      ]),\n      _: 1\n    }),\n    _createElementVNode(\"span\", _hoisted_4, [\n      _createVNode(_component_el_color_picker, {\n        class: \"color-picker\",\n        ref_key: \"background\",\n        ref: background,\n        onChange: setPredefined,\n        modelValue: _unref(cvs).backgroundColor,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_unref(cvs).backgroundColor) = $event)),\n        predefine: predefine.value,\n        \"show-alpha\": \"\"\n      }, null, 8, [\"modelValue\", \"predefine\"])\n    ])\n  ], 64))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=2707072a&scoped=true&lang=scss\"\n\nimport exportComponent from \"/Users/baoyukun/Workspace/canvas/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2707072a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-347cc8d6\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"menu\" }\n\nimport Pen from './pen/index.vue'\nimport Size from './size/index.vue'\nimport Color from './color/index.vue'\nimport Undo from './undo/index.vue'\nimport Redo from './redo/index.vue'\nimport MoreOptions from './more/index.vue'\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(Pen),\n    _createVNode(Size),\n    _createVNode(Color),\n    _createVNode(Undo),\n    _createVNode(Redo),\n    _createVNode(MoreOptions)\n  ]))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=347cc8d6&scoped=true&lang=scss\"\nimport \"./index.vue?vue&type=style&index=1&id=347cc8d6&lang=css\"\n\nimport exportComponent from \"/Users/baoyukun/Workspace/canvas/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-347cc8d6\"]])\n\nexport default __exports__","import { Canvas } from \"@/modules/canvas/\"\nimport { setting } from \"..\"\nimport Coord from '@/modules/coord'\n\nlet x0: number, x1: number, y0: number, y1: number;\n\nexport default function (cvs: Canvas): void {\n  cvs.on('touchstart', e => {\n    const ev = e as TouchEvent\n    if (ev.touches.length === 2) {\n      x0 = ev.touches[0].pageX\n      y0 = ev.touches[0].pageY\n      x1 = ev.touches[1].pageX\n      y1 = ev.touches[1].pageY\n    }\n  })\n\n  cvs.on('touchmove', e => {\n    const ev = e as TouchEvent\n    if (ev.touches.length === 2) {\n      const _x0 = ev.touches[0].pageX\n      const _y0 = ev.touches[0].pageY\n      const _x1 = ev.touches[1].pageX\n      const _y1 = ev.touches[1].pageY\n      const v = new Coord(x1 - x0, y1 - y0)\n      const _v = new Coord(_x1 - _x0, _y1 - _y0)\n      const ang = v.angle(_v.x, _v.y)\n      const angle = v.cross(_v.x, _v.y) > 0 ? ang : -ang\n      const k = _v.norm() / v.norm()\n      const c0 = cvs.getRelativeCoord((x0 + x1) / 2, (y0 + y1) / 2)\n      \n      cvs.rotation += angle\n      cvs.scale *= k\n      // cvs.scale = Math.min(5, Math.max(0.1, cvs.scale * k))\n      c0.rotate(cvs.rotation)\n        .scale(cvs.scale, cvs.scale)\n      const c1 = new Coord((_x0 + _x1) / 2, (_y0 + _y1) / 2).move(-c0.x, -c0.y)\n      cvs.x = c1.x\n      cvs.y = c1.y\n\n      x0 = _x0\n      x1 = _x1\n      y0 = _y0\n      y1 = _y1\n    }\n  })\n}","import { Canvas, Path } from \"@/modules/canvas/\"\nimport { memo, setting } from \"..\"\n\nlet path: Path | null = null;\nlet moved = false;\nconst offsetY = 45;\n\nexport default function (cvs: Canvas): void {\n  cvs.on('touchstart', e => {\n    const ev = e as TouchEvent\n    if (ev.touches.length === 1) {\n      const painter: {\n        type: 'pen' | 'eraser',\n        size: number,\n        force?: number,\n        color?: string\n      } = setting.mode === 'pen' ? { type: 'pen', ...setting.pen } : { type: 'eraser', ...setting.eraser }\n      const c = cvs.getRelativeCoord(ev.touches[0].pageX, ev.touches[0].pageY - offsetY)\n      path = new Path(painter)\n      path.data.push(c.x, c.y)\n    }\n  })\n\n  cvs.on('touchmove', e => {\n    const ev = e as TouchEvent\n    if (ev.touches.length === 1) {\n      if (path) {\n        const c = cvs.getRelativeCoord(ev.touches[0].pageX, ev.touches[0].pageY - offsetY)\n        path.data.push(c.x, c.y)\n        if (!moved) {\n          cvs.activePath = path\n          moved = true\n        }\n      }\n    }\n  })\n\n  cvs.on('touchend', () => {\n    if (moved) memo.add(path as Path)\n    moved = false;\n    cvs.activePath = null\n    path = null\n  })\n}","export default function magicWand (imageData: ImageData, px: number, py: number, threshold = 80): number[][] {\n  const distance = (p1: number[], p2: number[], threshold: number): boolean => {\n    let sum = 0;\n    for (let i = 0; i < 4; i++) {\n      sum += Math.abs(p1[i] - p2[i])\n      if (sum > threshold) return false;\n    }\n    return true;\n  }\n\n  const d = imageData.data;\n  const w = imageData.width;\n  const h = imageData.height;\n  const checked = new Set();\n  const res = [[px, py]];\n  const i = (py * w + px) * 4;\n  const p0 = [d[i], d[i + 1], d[i + 2], d[i + 3]];\n\n  const check = (x: number, y: number) => {\n    if (checked.has(`${x},${y}`)) return\n    checked.add(`${x},${y}`);\n\n    const i = (y * w + x) * 4;\n    if (distance(p0, [d[i], d[i + 1], d[i + 2], d[i + 3]], threshold)) {\n      res.push([x, y])\n    }\n  }\n\n  let index = 0\n  while (index < res.length) {\n    const [x, y] = res[index];\n    \n    if (y > 0) check(x, y - 1)\n    if (x > 0) check(x - 1, y)\n    if (x < w - 1) check(x + 1, y)\n    if (y < h - 1) check(x, y + 1)\n    index++;\n  }\n\n  return res;\n}","import { Layer, BoundingBox } from \".\"\nimport Coord from \"@/modules/coord\"\nexport default class Path extends Layer {\n  type = 'Rasterized'\n  x = 0\n  y = 0\n  width = 100\n  height = 100\n  rotation = 0\n  img: HTMLCanvasElement\n  _boundingBox?: BoundingBox;\n\n  get boundingBox () {\n    const { x, y, width: w, height: h, rotation } = this\n    const ps = [[w, 0], [w, h], [0, h]]\n    let x0 = 0\n    let y0 = 0\n    let x1 = 0\n    let y1 = 0\n    ps.forEach(p => {\n      const { x: _x, y: _y } = new Coord(p[0], p[1]).rotate(rotation)\n      if (_x < x0) x0 = _x\n      if (_x > x1) x1 = _x\n      if (_y < y0) y0 = _y\n      if (_y > y1) y1 = _y\n    })\n    return {\n      x: x0 + x,\n      y: y0 + y,\n      w: x1 - x0,\n      h: y1 - y0\n    }\n  }\n\n  constructor (img: HTMLCanvasElement, x: number, y: number, w: number, h: number, rotation: number) {\n    super()\n    this.img = img\n    this.x = x\n    this.y = y\n    this.width = w\n    this.height = h\n    this.rotation = rotation\n  }\n\n  draw (ctx: CanvasRenderingContext2D): void {\n    ctx.translate(this.x, this.y)\n    ctx.rotate(this.rotation)\n    ctx.drawImage(this.img, 0, 0, this.width, this.height)\n  }\n}","import { Canvas } from \"@/modules/canvas/\"\nimport { memo, setting } from \"..\"\nimport magicWand from \"@/modules/canvas/utils/magicWand\"\nimport Rasterized from '@/modules/canvas/layer/Rasterized'\n\n\nlet x: number, y: number\nconst offsetY = 45;\n\nexport default function (cvs: Canvas): void {\n  cvs.on('drop', e => {\n    const ev = e as { x: number, y: number }\n    x = Math.floor(ev.x)\n    y = Math.floor(ev.y - offsetY)\n    \n    const imageData = cvs.ctx.getImageData(0, 0, cvs.width, cvs.height)\n    const res = magicWand(imageData, x, y, 50)\n    let x0 = res[0][0]\n    let x1 = x0\n    let y0 = res[0][1]\n    let y1 = y0\n    res.forEach(([_x, _y]) => {\n      if (x0 === undefined || _x < x0) x0 = _x\n      if (y0 === undefined || _y < y0) y0 = _y\n      if (x1 === undefined || _x > x1) x1 = _x\n      if (y1 === undefined || _y > y1) y1 = _y\n    })\n    const _cvs = document.createElement('canvas')\n    _cvs.width = x1 - x0 + 1\n    _cvs.height = y1 - y0 + 1\n    const _ctx = _cvs.getContext('2d') as CanvasRenderingContext2D;\n    _ctx.fillStyle = setting.pen.color\n    res.forEach(([px, py]) => _ctx.fillRect(px - x0, py - y0, 1, 1))\n    const v = cvs.getRelativeCoord(x0, y0)\n    const w = Math.round((x1 - x0) / cvs.scale)\n    const h = Math.round((y1 - y0) / cvs.scale)\n    const layer = new Rasterized(_cvs, v.x, v.y, w, h, -cvs.rotation)\n    memo.add(layer)\n  })\n}","import { Canvas } from \"@/modules/canvas\";\nimport panzoom from \"./panzoom\";\nimport draw from \"./draw\";\nimport buket from \"./buket\";\n\nexport default function (cvs: Canvas): void {\n  draw(cvs)\n  panzoom(cvs)\n  buket(cvs)\n}","import { defineComponent as _defineComponent } from 'vue'\nimport { withModifiers as _withModifiers, createVNode as _createVNode, createElementVNode as _createElementVNode, resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, Transition as _Transition, withCtx as _withCtx, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-8cf3083e\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"page-wrap flex-v\" }\nconst _hoisted_2 = { key: 0 }\nconst _hoisted_3 = { class: \"drawer-wrap\" }\n\nimport { ref, onMounted, onBeforeMount, provide, markRaw, VueElement } from 'vue'\nimport Tools from './components/tools/index.vue'\nimport initEvent from './event/index'\nimport { cvs, memo, setting } from './index'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst cvsWrap = ref()\nconst Drawer = ref()\nconst closeDrawer = (): void => { Drawer.value = null }\nlet animateId: number | null = null\n\nconst render = () => {\n  cvs.drawFrame()\n  animateId = window.requestAnimationFrame(render)\n}\n\nprovide('openDrawer', (drawer: VueElement) => Drawer.value = markRaw(drawer))\nprovide('closeDrawer', closeDrawer)\nprovide('cvs', cvs)\nprovide('setting', setting)\nprovide('memo', memo)\n\nonMounted(() => {\n  cvs.mount(cvsWrap.value)\n  initEvent(cvs)\n  render()\n})\n\nonBeforeMount(() => {\n  if (animateId) window.cancelAnimationFrame(animateId)\n})\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _createVNode(Tools, {\n        class: \"flex-item\",\n        onGesturestart: _cache[0] || (_cache[0] = _withModifiers(() => {}, [\"prevent\"]))\n      }),\n      _createElementVNode(\"div\", {\n        ref_key: \"cvsWrap\",\n        ref: cvsWrap,\n        class: \"flex-main\"\n      }, null, 512)\n    ]),\n    _createVNode(_Transition, { name: \"drawer\" }, {\n      default: _withCtx(() => [\n        (Drawer.value)\n          ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n              _createElementVNode(\"div\", {\n                class: \"modal\",\n                onClick: closeDrawer\n              }),\n              _createElementVNode(\"div\", _hoisted_3, [\n                _createElementVNode(\"span\", {\n                  class: \"closeicon iconfont icon-halfscreen\",\n                  onClick: closeDrawer\n                }),\n                (_openBlock(), _createBlock(_resolveDynamicComponent(Drawer.value)))\n              ])\n            ]))\n          : _createCommentVNode(\"\", true)\n      ]),\n      _: 1\n    })\n  ], 64))\n}\n}\n\n})","import script from \"./index.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./index.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./index.vue?vue&type=style&index=0&id=8cf3083e&scoped=true&lang=scss\"\nimport \"./index.vue?vue&type=style&index=1&id=8cf3083e&lang=css\"\n\nimport exportComponent from \"/Users/baoyukun/Workspace/canvas/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-8cf3083e\"]])\n\nexport default __exports__","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=8cf3083e&scoped=true&lang=scss\"","export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=92ac15c6&scoped=true&lang=scss\"","export * from \"-!../../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=2845444e&scoped=true&lang=scss\"","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=1&id=347cc8d6&lang=css\"","export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=2707072a&scoped=true&lang=scss\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=1&id=8cf3083e&lang=css\""],"sourceRoot":""}